var p2pID, peer, connectedPeer;
var activeConnections = {};
function P2PInit(){
	peer = new Peer({key: 52wkj9kt0t9ms4i,
		debug:3,
		config: {'iceServers': [
		{ url: 'stun:stun.l.google.com:19302' },
	    { url: 'turn:homeo@turn.bistri.com:80', credential: 'homeo' }
	]}});
	
	peer.on('open', function(id){
		p2pID = id;
		$("#infotext").append("<div>P2P ID: "+ p2pID + "</div>");
	});
	
	
}

function connectionReceived(connection) {
	if(connection.label === 'request') {
		connectedPeer = connection.peer;
		$("#infotext").append("<div>Request from: "+ connection.peer + "</div>");
		var request = $.parseJSON(connection.metadata);
		var pIDRequested = request["patient"];
		$("#infotext").append("<div>Requested Patient ID: "+ pIDRequested + "</div>");
		activeConnections{connectedPeer} = 1;
		
		sendPatientInfo(connection, pIDRequested);
	}
}