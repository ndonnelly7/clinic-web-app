$(document).ready(function() {
	$.ajax('/webrtceval.do', {
		method:'GET',
		dataType:'text',
		data: {
			type:"ClinicsList"
		},
		success:function(response) {
			$("#infotext").append("<div>Response from ClinicsList Request: </div>");
			$("#infotext").append("<div>"+response+"</div>");
			var arr = $.parseJSON(response);
			arr.map( function(item){
				$("#clinic_list").append('<option value=' + item + '>' + item + '</option>');
			});
		}
	}); 
});
  
function newClinicChosen(){
	var clinicN = $('#clinic_list').val() + " Clinic";
	if(clinicN.indexOf("Choose") != -1){
		$("#clinician_options").slideUp(1000);
		$('#peer_list option').each(function() {
			if ( $(this).val() != 'invalid' ) {
				$(this).remove();
			}
		});
		return;
	} else {
		$("#infotext").append("<div>"+clinicN+"</div>");
		$.ajax('/webrtceval.do', {
			method:'GET',
			dataType:'text',
			data: {
				type:"ClientsFromClinic",
				clinic:clinicN
			},
			success:function(response) {
				$("#infotext").append("<div>Response from ClientsFromClinic Request: </div>");
				$("#infotext").append("<div>"+response+"</div>");
				$('#clinician_options').slideDown(1000);
				if(response != "") {
					var arr = $.parseJSON(response);
					arr.map( function(item){
						$("#peer_list").append('<option value=' + item + '>' + item + '</option>');
					});
				}
				$("#peer_list").append('<option value="new">New User</option>');
			}
		}); 
	}
}
  
function clientChosen(){
	var clientPick = $('#peer_list').val();
	if(clientPick=="invalid"){
		$('#name_field').prop('disabled', true);
		$('#newUser').prop('disabled', true);
		$('#userChosen').prop('disabled',true);
		$('#newUser').hide();
		$('#userChosen').hide();
	}
}